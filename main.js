!function(){"use strict";const e={formSelector:".form",labelSelector:".form__field",inputSelector:".form__input",inputErrorSelector:".form__error-msg",inputErrorClass:"form__input_type_error",messsageErrorClass:"form__error-msg_visible",submitButtonSelector:".form__button_type_submit",inactiveButtonClass:"form__button_disabled"},t=".card-template",s=".card__image",r=".card__like-btn",n="popup_is-opened",i=".popup__image",o=".popup_type_edit",l=".popup_type_new-card",a=document.querySelector(".profile__edit-btn"),c=document.querySelector(".profile__add-btn");document.querySelector(".profile__title"),document.querySelector(".profile__description");class _{constructor(e,t){let{name:s,link:r}=e,{cardSelector:n,handleImageClick:i}=t;this._name=s,this._link=r,this._cardSelector=n,this._handleImageClick=i}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__delete-btn").addEventListener("click",(()=>this._handleDeleteCard())),this._element.querySelector(r).addEventListener("click",(()=>this._handleLikeCard())),this._element.querySelector(s).addEventListener("click",(()=>this._handleImageClick({name:this._name,link:this._link})))}_handleDeleteCard(){this._element.remove()}_handleLikeCard(){this._element.querySelector(r).classList.toggle("card__like-btn_is-active")}generateCard(){return this._element=this._getTemplate(),this._setEventListeners(),this._element.querySelector(s).src=this._link,this._element.querySelector(s).alt=this._name,this._element.querySelector(".card__title").textContent=this._name,this._element}}class p{constructor(e){this._popup=document.querySelector(e)}open(){this._popup.classList.add(n),document.addEventListener("keyup",(e=>this._handleEscClose(e)))}close(){this._popup.classList.remove(n),document.removeEventListener("keyup",(e=>this._handleEscClose(e)))}_handleEscClose(e){"Escape"===e.key&&this.close()}setEventListeners(){this._popup.addEventListener("click",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__close-btn"))&&this.close()}))}}class u extends p{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super(t),this._form=this._popup.querySelector(".form"),this._handleFormSubmit=s}_getInputValues(){return this._formValues={},this._inputList=this._form.querySelectorAll(".form__input"),this._inputList.forEach((e=>this._formValues[e.name]=e.value)),this._formValues}close(){this._form.reset(),super.close()}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()}))}}class d{constructor(e,t){let{labelSelector:s,inputSelector:r,inputErrorSelector:n,inputErrorClass:i,messsageErrorClass:o,submitButtonSelector:l,inactiveButtonClass:a}=e;this._inputSelector=r,this._labelSelector=s,this._inputErrorSelector=n,this._inputErrorClass=i,this._messsageErrorClass=o,this._submitButtonSelector=l,this._inactiveButtonClass=a,this._popup=document.querySelector(t)}_getErrorElement(e){return e.closest(this._labelSelector).querySelector(this._inputErrorSelector)}_hasInvalidInputs(e){return e.some((e=>!e.validity.valid))}_toggleButtonState(e,t){this._hasInvalidInputs(e)?t.classList.add(this._inactiveButtonClass):t.classList.remove(this._inactiveButtonClass)}_setEventListeners(){this._inputList=Array.from(this._popup.querySelectorAll(this._inputSelector)),this._submitBtn=this._popup.querySelector(this._submitButtonSelector),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._isValid(e),this._toggleButtonState(this._inputList,this._submitBtn)}))}))}_isValid(e){return e.validity.valid?this._hideError(e):this._showError(e)}_showError(e){const t=this._getErrorElement(e);t.textContent=e.validationMessage,t.classList.add(this._messsageErrorClass),e.classList.add(this._inputErrorClass)}_hideError(e){this._getErrorElement(e).classList.remove(this._messsageErrorClass),e.classList.remove(this._inputErrorClass)}enableValidation(){this._popup.addEventListener("submit",(e=>e.preventDefault())),this._setEventListeners()}}const h=new class extends p{open(e){let{name:t,link:s}=e;this._popup.querySelector(i).src=s,this._popup.querySelector(i).alt=t,this._popup.querySelector(".popup__caption").textContent=t,super.open()}}(".popup_type_image"),m=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}_clear(){this._container.innerHTML=""}renderItems(e){e.forEach((e=>this._renderer(e)))}}({renderer:e=>{const s=new _(e,{cardSelector:t,handleImageClick:()=>h.open(e)});m.addItem(s.generateCard())}},".cards__list"),S=new u({popupSelector:o,handleFormSubmit:e=>{y.setUserInfo(e)}}),E=new u({popupSelector:l,handleFormSubmit:e=>{const s=new _(e,{cardSelector:t,handleImageClick:()=>h.open(e)});m.addItem(s.generateCard())}}),y=new class{constructor(e){let{nameSelector:t,descriptionSelector:s}=e;this._name=document.querySelector(t),this._description=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,description:this._description.innerText}}setUserInfo(e){let{name:t,description:s}=e;this._name.textContent=t,this._description.innerText=s}}({nameSelector:".profile__title",descriptionSelector:".profile__description"}),v=new d(e,o),g=new d(e,l);m.renderItems([{name:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"},{name:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{name:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{name:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{name:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{name:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"}]),E.setEventListeners(),S.setEventListeners(),h.setEventListeners(),g.enableValidation(),v.enableValidation();const L=document.querySelector(".form__input_type_name"),b=document.querySelector(".form__input_type_description");a.addEventListener("click",(()=>{const e=y.getUserInfo();L.value=e.name,b.value=e.description,S.open()})),c.addEventListener("click",(()=>{E.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0VELEtBQU0sY0FDTkMsS0FBTSx1REFFUixDQUNFRCxLQUFNLGlCQUNOQyxLQUFNLDBEQUVSLENBQ0VELEtBQU0sVUFDTkMsS0FBTSxtREFFUixDQUNFRCxLQUFNLHdCQUNOQyxLQUFNLG1EQUVSLENBQ0VELEtBQU0saUJBQ05DLEtBQU0sa0RLMkRWZ0csRUFBYS9ELG9CQUNiMkQsRUFBaUIzRCxvQkFDakI0QyxFQUFXNUMsb0JBRVh3RSxFQUFxQjdCLG1CQUNyQjRCLEVBQXlCNUIsbUJBR3pCLE1BQU04QixFQUF1QmhILFNBQVNDLGNBQWMsMEJBQzlDZ0gsRUFBOEJqSCxTQUFTQyxjQUMzQyxpQ0FJRkYsRUFBZW9CLGlCQUFpQixTQUFTLEtBQ3ZDLE1BQU0rRixFQUFrQmQsRUFBWU8sY0FDcENLLEVBQXFCM0QsTUFBUTZELEVBQWdCN0csS0FDN0M0RyxFQUE0QjVELE1BQVE2RCxFQUFnQk4sWUFDcERWLEVBQWlCbEUsVUFHbkI5QixFQUFXaUIsaUJBQWlCLFNBQVMsS0FDbkNtRixFQUFhdEUsVSIsInNvdXJjZXMiOlsid2VicGFjazovL3lhbmRleF9wcmFjdGljdW0vLi9zY3JpcHRzL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly95YW5kZXhfcHJhY3RpY3VtLy4vc2NyaXB0cy9jb21wb25lbnRzL2NhcmQuanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWN0aWN1bS8uL3NjcmlwdHMvY29tcG9uZW50cy9wb3B1cC5qcyIsIndlYnBhY2s6Ly95YW5kZXhfcHJhY3RpY3VtLy4vc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8veWFuZGV4X3ByYWN0aWN1bS8uL3NjcmlwdHMvY29tcG9uZW50cy9mb3JtVmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly95YW5kZXhfcHJhY3RpY3VtLy4vc2NyaXB0cy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly95YW5kZXhfcHJhY3RpY3VtLy4vc2NyaXB0cy9jb21wb25lbnRzL3BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3lhbmRleF9wcmFjdGljdW0vLi9zY3JpcHRzL2NvbXBvbmVudHMvc2VjdGlvbi5qcyIsIndlYnBhY2s6Ly95YW5kZXhfcHJhY3RpY3VtLy4vc2NyaXB0cy9jb21wb25lbnRzL3VzZXJJbmZvLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1Db25maWcgPSB7XHJcbiAgZm9ybVNlbGVjdG9yOiBcIi5mb3JtXCIsXHJcbiAgbGFiZWxTZWxlY3RvcjogXCIuZm9ybV9fZmllbGRcIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gIGlucHV0RXJyb3JTZWxlY3RvcjogXCIuZm9ybV9fZXJyb3ItbXNnXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcImZvcm1fX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBtZXNzc2FnZUVycm9yQ2xhc3M6IFwiZm9ybV9fZXJyb3ItbXNnX3Zpc2libGVcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fYnV0dG9uX3R5cGVfc3VibWl0XCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJmb3JtX19idXR0b25fZGlzYWJsZWRcIixcclxufTtcclxuXHJcbi8vIENhcmQgdGVtcGxhdGVcclxuZXhwb3J0IGNvbnN0IGNhcmRUZW1wbGF0ZVNlbGVjdG9yID0gXCIuY2FyZC10ZW1wbGF0ZVwiO1xyXG5leHBvcnQgY29uc3QgY2FyZFNlbGVjdG9yID0gXCIuY2FyZFwiO1xyXG5leHBvcnQgY29uc3QgY2FyZEltYWdlU2VsZWN0b3IgPSBcIi5jYXJkX19pbWFnZVwiO1xyXG5leHBvcnQgY29uc3QgY2FyZFRpdGxlU2VsZWN0b3IgPSBcIi5jYXJkX190aXRsZVwiO1xyXG5leHBvcnQgY29uc3QgY2FyZERlbGV0ZUJ0blNlbGVjdG9yID0gXCIuY2FyZF9fZGVsZXRlLWJ0blwiO1xyXG5leHBvcnQgY29uc3QgY2FyZExpa2VTZWxlY3RvciA9IFwiLmNhcmRfX2xpa2UtYnRuXCI7XHJcbmV4cG9ydCBjb25zdCBjYXJkSXNMaWtlZENsYXNzID0gXCJjYXJkX19saWtlLWJ0bl9pcy1hY3RpdmVcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBjYXJkTGlzdFNlbGVjdG9yID0gXCIuY2FyZHNfX2xpc3RcIjtcclxuXHJcbi8vIFBvcHVwXHJcbmV4cG9ydCBjb25zdCBwb3B1cElzT3BlbmVkQ2xhc3MgPSBcInBvcHVwX2lzLW9wZW5lZFwiO1xyXG5leHBvcnQgY29uc3QgcG9wdXBTZWxlY3RvciA9IFwiLnBvcHVwXCI7XHJcbmV4cG9ydCBjb25zdCBwb3B1cENsYXNzID0gXCJwb3B1cFwiO1xyXG5leHBvcnQgY29uc3QgcG9wdXBDbG9zZUJ0bkNsYXNzID0gXCJwb3B1cF9fY2xvc2UtYnRuXCI7XHJcbmV4cG9ydCBjb25zdCBFU0NfS0VZID0gXCJFc2NhcGVcIjtcclxuXHJcbi8vIFBvcHVwV2l0aEltYWdlXHJcbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlVHlwZVNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9pbWFnZVwiO1xyXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZVNlbGVjdG9yID0gXCIucG9wdXBfX2ltYWdlXCI7XHJcbmV4cG9ydCBjb25zdCBwb3B1cENhcHRpb25TZWxlY3RvciA9IFwiLnBvcHVwX19jYXB0aW9uXCI7XHJcblxyXG4vLyBQb3B1cFdpdGhGb3JtXHJcbmV4cG9ydCBjb25zdCBwb3B1cEVkaXRQcm9maWxlU2VsZWN0b3IgPSBcIi5wb3B1cF90eXBlX2VkaXRcIjtcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkQ2FyZFNlbGVjdG9yID0gXCIucG9wdXBfdHlwZV9uZXctY2FyZFwiO1xyXG5cclxuLy8gRm9ybVxyXG5leHBvcnQgY29uc3QgZm9ybVNlbGVjdG9yID0gXCIuZm9ybVwiO1xyXG5leHBvcnQgY29uc3QgZm9ybUlucHV0U2VsZWN0b3IgPSBcIi5mb3JtX19pbnB1dFwiO1xyXG5cclxuLy8gRG9tIEVsZW1lbnRzXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idG5cIik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgdXNlck5hbWVTZWxlY3RvciA9IFwiLnByb2ZpbGVfX3RpdGxlXCI7XHJcbmV4cG9ydCBjb25zdCB1c2VyRGVzY3JpcHRpb25TZWxlY3RvciA9IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCI7XHJcbiIsImltcG9ydCB7XHJcbiAgY2FyZFNlbGVjdG9yLFxyXG4gIGNhcmRJbWFnZVNlbGVjdG9yLFxyXG4gIGNhcmRUaXRsZVNlbGVjdG9yLFxyXG4gIGNhcmREZWxldGVCdG5TZWxlY3RvcixcclxuICBjYXJkTGlrZVNlbGVjdG9yLFxyXG4gIGNhcmRJc0xpa2VkQ2xhc3MsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lLCBsaW5rIH0sIHsgY2FyZFNlbGVjdG9yLCBoYW5kbGVJbWFnZUNsaWNrIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKGNhcmRTZWxlY3RvcilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKGNhcmREZWxldGVCdG5TZWxlY3RvcilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKCkpO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoY2FyZExpa2VTZWxlY3RvcilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVMaWtlQ2FyZCgpKTtcclxuXHJcbiAgICB0aGlzLl9lbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKGNhcmRJbWFnZVNlbGVjdG9yKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSlcclxuICAgICAgKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVEZWxldGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoY2FyZExpa2VTZWxlY3RvcilcclxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoY2FyZElzTGlrZWRDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGNhcmRJbWFnZVNlbGVjdG9yKS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGNhcmRJbWFnZVNlbGVjdG9yKS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKGNhcmRUaXRsZVNlbGVjdG9yKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7XHJcbiAgcG9wdXBJc09wZW5lZENsYXNzLFxyXG4gIEVTQ19LRVksXHJcbiAgcG9wdXBDbG9zZUJ0bkNsYXNzLFxyXG4gIHBvcHVwQ2xhc3MsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKHBvcHVwSXNPcGVuZWRDbGFzcyk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwgKGV2dCkgPT4gdGhpcy5faGFuZGxlRXNjQ2xvc2UoZXZ0KSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUocG9wdXBJc09wZW5lZENsYXNzKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCAoZXZ0KSA9PiB0aGlzLl9oYW5kbGVFc2NDbG9zZShldnQpKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcclxuICAgIGlmIChldnQua2V5ID09PSBFU0NfS0VZKSB0aGlzLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhwb3B1cENsYXNzKSB8fFxyXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKHBvcHVwQ2xvc2VCdG5DbGFzcylcclxuICAgICAgKSB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgZm9ybUlucHV0U2VsZWN0b3IsIGZvcm1TZWxlY3RvciB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuL3BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKGZvcm1TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIHRoaXMuX2Zvcm1WYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChmb3JtSW5wdXRTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChcclxuICAgICAgKGlucHV0KSA9PiAodGhpcy5fZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlKVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRpb24ge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAge1xyXG4gICAgICBsYWJlbFNlbGVjdG9yLFxyXG4gICAgICBpbnB1dFNlbGVjdG9yLFxyXG4gICAgICBpbnB1dEVycm9yU2VsZWN0b3IsXHJcbiAgICAgIGlucHV0RXJyb3JDbGFzcyxcclxuICAgICAgbWVzc3NhZ2VFcnJvckNsYXNzLFxyXG4gICAgICBzdWJtaXRCdXR0b25TZWxlY3RvcixcclxuICAgICAgaW5hY3RpdmVCdXR0b25DbGFzcyxcclxuICAgIH0sXHJcbiAgICBwb3B1cFNlbGVjdG9yXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2xhYmVsU2VsZWN0b3IgPSBsYWJlbFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvclNlbGVjdG9yID0gaW5wdXRFcnJvclNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fbWVzc3NhZ2VFcnJvckNsYXNzID0gbWVzc3NhZ2VFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBpbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX2dldEVycm9yRWxlbWVudChpbnB1dEVsZW1lbnQpIHtcclxuICAgIHJldHVybiBpbnB1dEVsZW1lbnRcclxuICAgICAgLmNsb3Nlc3QodGhpcy5fbGFiZWxTZWxlY3RvcilcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5faW5wdXRFcnJvclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXRzKGlucHV0TGlzdCkge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQ7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2hhc0ludmFsaWRJbnB1dHMoaW5wdXRMaXN0KVxyXG4gICAgICA/IGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKVxyXG4gICAgICA6IGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faXNWYWxpZChpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKHRoaXMuX2lucHV0TGlzdCwgdGhpcy5fc3VibWl0QnRuKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9pc1ZhbGlkKGlucHV0RWxlbWVudCkge1xyXG4gICAgcmV0dXJuICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICAgPyB0aGlzLl9zaG93RXJyb3IoaW5wdXRFbGVtZW50KVxyXG4gICAgICA6IHRoaXMuX2hpZGVFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2dldEVycm9yRWxlbWVudChpbnB1dEVsZW1lbnQpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fbWVzc3NhZ2VFcnJvckNsYXNzKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZ2V0RXJyb3JFbGVtZW50KGlucHV0RWxlbWVudCk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9tZXNzc2FnZUVycm9yQ2xhc3MpO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IGV2dC5wcmV2ZW50RGVmYXVsdCgpKTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4uLy4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5cclxuaW1wb3J0IHtcclxuICBpbml0aWFsQ2FyZHMsXHJcbiAgY2FyZFRlbXBsYXRlU2VsZWN0b3IsXHJcbiAgY2FyZExpc3RTZWxlY3RvcixcclxuICBwb3B1cEltYWdlVHlwZVNlbGVjdG9yLFxyXG4gIHBvcHVwRWRpdFByb2ZpbGVTZWxlY3RvcixcclxuICBlZGl0UHJvZmlsZUJ0bixcclxuICBwb3B1cEFkZENhcmRTZWxlY3RvcixcclxuICBhZGRDYXJkQnRuLFxyXG4gIHVzZXJOYW1lU2VsZWN0b3IsXHJcbiAgdXNlckRlc2NyaXB0aW9uU2VsZWN0b3IsXHJcbiAgZm9ybUNvbmZpZyxcclxufSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9jYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL3NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL3BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL3BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL3VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9mb3JtVmFsaWRhdGlvbi5qc1wiO1xyXG5cclxuLy8gPT09PT09PT09PT09PT0gQ2FyZCA9PT09PT09PT09PT09PT09PT09PVxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKHBvcHVwSW1hZ2VUeXBlU2VsZWN0b3IpO1xyXG5cclxuY29uc3QgcmVuZGVyQ2FyZHMgPSAoaXRlbSkgPT4ge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChpdGVtLCB7XHJcbiAgICBjYXJkU2VsZWN0b3I6IGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljazogKCkgPT4gaW1hZ2VQb3B1cC5vcGVuKGl0ZW0pLFxyXG4gIH0pO1xyXG4gIENhcmRMaXN0LmFkZEl0ZW0oY2FyZC5nZW5lcmF0ZUNhcmQoKSk7XHJcbn07XHJcblxyXG5jb25zdCBDYXJkTGlzdCA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkcyxcclxuICB9LFxyXG4gIGNhcmRMaXN0U2VsZWN0b3JcclxuKTtcclxuXHJcbi8vID09PT09PT09PT09PT09IEVkaXQgUHJvZmlsZSA9PT09PT09PT09PT09PVxyXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IHBvcHVwRWRpdFByb2ZpbGVTZWxlY3RvcixcclxuICBoYW5kbGVGb3JtU3VibWl0OiAoZm9ybURhdGEpID0+IHtcclxuICAgIHVzZXJQcm9maWxlLnNldFVzZXJJbmZvKGZvcm1EYXRhKTtcclxuICB9LFxyXG59KTtcclxuXHJcbi8vID09PT09PT09PT09PT09IEFkZCBuZXcgUGxhY2UgPT09PT09PT09PT09PT1cclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IHBvcHVwQWRkQ2FyZFNlbGVjdG9yLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoZGF0YSwge1xyXG4gICAgICBjYXJkU2VsZWN0b3I6IGNhcmRUZW1wbGF0ZVNlbGVjdG9yLFxyXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoKSA9PiBpbWFnZVBvcHVwLm9wZW4oZGF0YSksXHJcbiAgICB9KTtcclxuICAgIENhcmRMaXN0LmFkZEl0ZW0oY2FyZC5nZW5lcmF0ZUNhcmQoKSk7XHJcbiAgfSxcclxufSk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PSBVc2VySW5mbyA9PT09PT09PT09PT09PT09PT09PT1cclxuY29uc3QgdXNlclByb2ZpbGUgPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWVTZWxlY3RvcjogdXNlck5hbWVTZWxlY3RvcixcclxuICBkZXNjcmlwdGlvblNlbGVjdG9yOiB1c2VyRGVzY3JpcHRpb25TZWxlY3RvcixcclxufSk7XHJcblxyXG4vLyA9PT09PT09PT09PT09PSBGb3JtIFZhbGlkYXRpb24gPT09PT09PT09PT09PT1cclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdGlvbihcclxuICBmb3JtQ29uZmlnLFxyXG4gIHBvcHVwRWRpdFByb2ZpbGVTZWxlY3RvclxyXG4pO1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRpb24oXHJcbiAgZm9ybUNvbmZpZyxcclxuICBwb3B1cEFkZENhcmRTZWxlY3RvclxyXG4pO1xyXG5cclxuLy8gPT09PT09PT09PT09PT0gUmVuZGVyIEFsbCBDYXJkcyA9PT09PT09PT09PT09PVxyXG5DYXJkTGlzdC5yZW5kZXJJdGVtcyhpbml0aWFsQ2FyZHMpO1xyXG5cclxuYWRkQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5lZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8gRE9NIGVsZW1lbnRzIG9ubHkgZm9yIGluZGV4Lmh0bWxcclxuY29uc3QgdXNlck5hbWVJbnB1dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX2lucHV0X3R5cGVfbmFtZVwiKTtcclxuY29uc3QgdXNlckRlc2NyaXB0aW9uSW5wdXRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5mb3JtX19pbnB1dF90eXBlX2Rlc2NyaXB0aW9uXCJcclxuKTtcclxuXHJcbi8vID09PT09PT09PT09PT0gTGlzdGVuZXJzIG9uIHRoZSBwYWdlID09PT09PT09PT09PT09PT09PT09XHJcbmVkaXRQcm9maWxlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgY3VycmVudFVzZXJEYXRhID0gdXNlclByb2ZpbGUuZ2V0VXNlckluZm8oKTtcclxuICB1c2VyTmFtZUlucHV0RWxlbWVudC52YWx1ZSA9IGN1cnJlbnRVc2VyRGF0YS5uYW1lO1xyXG4gIHVzZXJEZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZSA9IGN1cnJlbnRVc2VyRGF0YS5kZXNjcmlwdGlvbjtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5hZGRDYXJkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkQ2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcbiIsImltcG9ydCB7XHJcbiAgcG9wdXBJbWFnZVNlbGVjdG9yLFxyXG4gIHBvcHVwQ2FwdGlvblNlbGVjdG9yLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuL3BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBvcGVuKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKHBvcHVwSW1hZ2VTZWxlY3Rvcikuc3JjID0gbGluaztcclxuICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IocG9wdXBJbWFnZVNlbGVjdG9yKS5hbHQgPSBuYW1lO1xyXG4gICAgdGhpcy5fcG9wdXAucXVlcnlTZWxlY3Rvcihwb3B1cENhcHRpb25TZWxlY3RvcikudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgX2NsZWFyKCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLmlubmVySFRNTCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4gdGhpcy5fcmVuZGVyZXIoaXRlbSkpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uLmlubmVyVGV4dCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb24uaW5uZXJUZXh0ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJmb3JtQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwibGFiZWxTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJpbnB1dEVycm9yU2VsZWN0b3IiLCJpbnB1dEVycm9yQ2xhc3MiLCJtZXNzc2FnZUVycm9yQ2xhc3MiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJjYXJkVGVtcGxhdGVTZWxlY3RvciIsImNhcmRJbWFnZVNlbGVjdG9yIiwiY2FyZExpa2VTZWxlY3RvciIsInBvcHVwSXNPcGVuZWRDbGFzcyIsInBvcHVwSW1hZ2VTZWxlY3RvciIsInBvcHVwRWRpdFByb2ZpbGVTZWxlY3RvciIsInBvcHVwQWRkQ2FyZFNlbGVjdG9yIiwiZWRpdFByb2ZpbGVCdG4iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZGRDYXJkQnRuIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwibmFtZSIsImxpbmsiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwidGhpcyIsIl9uYW1lIiwiX2xpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfZ2V0VGVtcGxhdGUiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2VsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJfaGFuZGxlTGlrZUNhcmQiLCJyZW1vdmUiLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJnZW5lcmF0ZUNhcmQiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIm9wZW4iLCJhZGQiLCJldnQiLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9mb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybVZhbHVlcyIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsInByZXZlbnREZWZhdWx0IiwiRm9ybVZhbGlkYXRpb24iLCJfaW5wdXRTZWxlY3RvciIsIl9sYWJlbFNlbGVjdG9yIiwiX2lucHV0RXJyb3JTZWxlY3RvciIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfbWVzc3NhZ2VFcnJvckNsYXNzIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfZ2V0RXJyb3JFbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY2xvc2VzdCIsIl9oYXNJbnZhbGlkSW5wdXRzIiwiaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJidXR0b25FbGVtZW50IiwiQXJyYXkiLCJmcm9tIiwiX3N1Ym1pdEJ0biIsIl9pc1ZhbGlkIiwiX2hpZGVFcnJvciIsIl9zaG93RXJyb3IiLCJlcnJvckVsZW1lbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImVuYWJsZVZhbGlkYXRpb24iLCJpbWFnZVBvcHVwIiwiQ2FyZExpc3QiLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsIl9jbGVhciIsImlubmVySFRNTCIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwiY2FyZCIsImVkaXRQcm9maWxlUG9wdXAiLCJmb3JtRGF0YSIsInVzZXJQcm9maWxlIiwic2V0VXNlckluZm8iLCJhZGRDYXJkUG9wdXAiLCJkYXRhIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsIl9kZXNjcmlwdGlvbiIsImdldFVzZXJJbmZvIiwiZGVzY3JpcHRpb24iLCJpbm5lclRleHQiLCJlZGl0UHJvZmlsZUZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsInVzZXJOYW1lSW5wdXRFbGVtZW50IiwidXNlckRlc2NyaXB0aW9uSW5wdXRFbGVtZW50IiwiY3VycmVudFVzZXJEYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==